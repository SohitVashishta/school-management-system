import{r as p,j as e}from"./index-Bvi5AaG_.js";import{u,w as T}from"./xlsx-DjuO7_Ju.js";import{C as c,a as d}from"./CRow-vSXVB6Z4.js";import{C as f,a as v}from"./CCardBody-CncvmFhX.js";import{C as S}from"./CCardHeader-DzukG7zH.js";import{C as _}from"./CForm-RL5qu1Ll.js";import{C as i}from"./CFormLabel-B4DC023o.js";import{C as h}from"./CFormInput-DLm92qrA.js";import{C as k}from"./CFormSelect-DwqI_a6J.js";import{a as m}from"./index.esm-PqmBDI7d.js";import{C as q,a as B,b as y,c as l,d as M,e as t}from"./CTable-VK8GYg8V.js";import"./CFormControlWrapper-DCkBt9XH.js";import"./CFormControlValidation-DStCodTq.js";const V=()=>{const[a,x]=p.useState([]),[r,j]=p.useState({name:"",email:"",dob:"",phone:"",gender:""}),[C,b]=p.useState(-1),o=s=>{const{name:n,value:g}=s.target;j({...r,[n]:g})},F=s=>{if(s.preventDefault(),C>=0){const n=[...a];n[C]=r,x(n),b(-1)}else x([...a,r]);j({name:"",email:"",dob:"",phone:"",gender:""})},E=s=>{j(a[s]),b(s)},w=s=>{const n=a.filter((g,N)=>N!==s);x(n)},D=()=>{const s=u.json_to_sheet(a),n=u.book_new();u.book_append_sheet(n,s,"Students"),T(n,"students.xlsx")};return e.jsxs("div",{children:[e.jsx("h1",{children:"Student Management"}),e.jsx("div",{children:e.jsx(c,{className:"justify-content-center py-4",children:e.jsx(d,{md:12,children:e.jsxs(f,{children:[e.jsx(S,{children:e.jsx("h5",{children:"Student Details"})}),e.jsx(v,{children:e.jsxs(_,{onSubmit:F,children:[e.jsxs(c,{children:[e.jsx(d,{md:4,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(i,{htmlFor:"name",children:"Name"}),e.jsx(h,{type:"text",id:"name",name:"name",placeholder:"Enter student's name",value:r.name,onChange:o,required:!0})]})}),e.jsx(d,{md:4,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(i,{htmlFor:"email",children:"Email"}),e.jsx(h,{type:"email",id:"email",name:"email",placeholder:"Enter student's email",value:r.email,onChange:o,required:!0})]})}),e.jsx(d,{md:4,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(i,{htmlFor:"dob",children:"Date of Birth"}),e.jsx(h,{type:"date",id:"dob",name:"dob",value:r.dob,onChange:o,required:!0})]})})]}),e.jsxs(c,{children:[e.jsx(d,{md:4,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(i,{htmlFor:"phone",children:"Phone Number"}),e.jsx(h,{type:"tel",id:"phone",name:"phone",placeholder:"Enter phone number",value:r.phone,onChange:o,required:!0})]})}),e.jsx(d,{md:4,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(i,{htmlFor:"gender",children:"Gender"}),e.jsxs(k,{id:"gender",name:"gender",value:r.gender,onChange:o,required:!0,children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]})]})})]}),e.jsx(m,{type:"submit",color:"primary",children:"Submit"})]})})]})})})}),e.jsx(c,{className:"justify-content-center py-4",children:e.jsx(d,{md:12,children:e.jsxs(f,{children:[e.jsxs(S,{children:[e.jsx("h5",{children:"Student List"}),e.jsx(m,{color:"success",onClick:D,children:"Download Excel"})]}),e.jsx(v,{children:e.jsxs(q,{striped:!0,hover:!0,children:[e.jsx(B,{children:e.jsxs(y,{children:[e.jsx(l,{scope:"col",children:"#"}),e.jsx(l,{scope:"col",children:"Name"}),e.jsx(l,{scope:"col",children:"Email"}),e.jsx(l,{scope:"col",children:"DOB"}),e.jsx(l,{scope:"col",children:"Phone"}),e.jsx(l,{scope:"col",children:"Gender"}),e.jsx(l,{scope:"col",children:"Actions"})]})}),e.jsx(M,{children:a.map((s,n)=>e.jsxs(y,{children:[e.jsx(l,{scope:"row",children:n+1}),e.jsx(t,{children:s.name}),e.jsx(t,{children:s.email}),e.jsx(t,{children:s.dob}),e.jsx(t,{children:s.phone}),e.jsx(t,{children:s.gender}),e.jsxs(t,{children:[e.jsx(m,{color:"warning",size:"sm",onClick:()=>E(n),children:"Edit"})," ",e.jsx(m,{color:"danger",size:"sm",onClick:()=>w(n),children:"Delete"})]})]},n))})]})})]})})})]})};export{V as default};
